Задача:
------------------------------------------------------------------------------------------------------------------------
Для команды казначейства и платежей требуется проверить сумму комиссии в соответствии с тарифами компании по
входящим от Банка Русский Стандарт(БРС) файлам.

Банк присылает файлы самостоятельно по email согласованному получателю, а так же есть возможность выгрузить файлы
самостоятельно из банк-клиента, с последующим сохранением на локальный диск.
------------------------------------------------------------------------------------------------------------------------
Реализация:
------------------------------------------------------------------------------------------------------------------------
Поскольку банк может прислать в разных форматах шрифта, таких как UTF-8 или Windows-1251, потребовалось преобразовать
все входящие файлы данные в единый формат Windows-1251. Кроме того, расширение, с которым банк отправляет файлы для
сверки могут быть разными: csv, xlsx, xls, dsv, dsvp, то потребовалось так же преобразование разных типов данных в
единый формат xlsx.
------------------------------------------------------------------------------------------------------------------------
Описание логики программы.
------------------------------------------------------------------------------------------------------------------------
Идет сканирование текущей директории на наличие файлов с расширением csv, xlsx, xls, dsv, dsvp, у которых нет
суффикса "_processed", не называются "results.xlsx", а так же "setup.xlsx". Если присутствует "_processed" суффикс. то
значит - это уже обработанная копия файла. Далее, по циклу идет обработка каждого из найденных файлов , идет скан на
присутствие обязательных полей ['TYPE', 'AMOUNT', 'COMMISSION', 'PMT_SYSTEM_CODE'], если отсутствуют, то выдаст ошибку:
Отсутствуют обязательные колонки: название колонки. Таким образом, файл не будет обработан, но в консоли будет и
информация, что файл пропущен.

Сумма из "Комиссия (расчет)" берется из колонки "AMOUNT"(L) и умножается на % комиссии считываемый из файла с
настройками setup.xlsx. В этом файле описаны все типы карт и их комиссии. Если этого файла не будет , то программа не
выдаст ошибку. а лишь будет обрабатывать по тарифам комиссии указанным внутри кода программы, но так делать не
рекомендуется, поскольку данные могут отличаться с течением времени. В приоритете данные в файле setup.xlsx, поэтому,
если он есть в папке, то данные берутся оттуда.

Если разница = 0, то колонка "Разница (F - U)" окрашивается в серый цвет, если отрицательная разница, то в красный цвет,
если положительная разница, то в зеленый цвет.

Далее, все файлы проходят весь цикл и создается итоговый(консолидированный) файл results.xlsx, где сохраняются все суммы
отличные от нуля во всех файлах.

Для того, чтобы прогнать программу заново, необязательно удалять файлы с суффиксами _processed, можно их оставить.

------------------------------------------------------------------------------------------------------------------------
Деплой на PC
------------------------------------------------------------------------------------------------------------------------

- Скачиваем файл по ссылке проекта. Обычно это команда из любой IDE(PyCharm, VSCode и т.п.) среды: git
  clone https://github.com/Iceeyess/check-commission-Treasury-BRS
- Устанавливаем все зависимости из файла requirements.txt через команду в bash: pip3 install -r requirements.txt
- Создаем исполняемый файл через команду: pyinstaller .\run_calc_commission_BRS.py
- Создастся 2 папки: build и dict. Заходим в dict, копируем папку "_internal" в своей проект, в котором будут
  вычисления, и
  исполняемый файл run_calc_commission_BRS.exe. Так же копируем файл setup.xlsx из текущего проекта, и так же переносим его
  в свой проект. Итого будет: 1 папка и 2 файла.
- Копируем файлы от БРС банка и переносим в своей исполняемый проект. Ввиду безопасности данных не стал прикладывать
  их на github. 